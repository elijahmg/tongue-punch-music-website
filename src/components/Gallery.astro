---
interface Props {
  images: string[];
}

const { images } = Astro.props;
const displayImages = images.slice(0, 8);

// bg-linear-to-b from-fuchsia-300 to-white
---

<section id="media" class="min-h-screen  flex flex-col items-center py-20 px-8">
  <h2 class="text-white text-8xl tracking-widest uppercase text-center mb-12">Media</h2>

  <div class="w-full max-w-4xl flex-1 flex items-center justify-center">
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 w-full">
      {displayImages.map((src, index) => (
        <div class="aspect-square overflow-hidden rounded-lg group cursor-pointer gallery-item" data-src={src}>
          <img
            src={src}
            alt={`Gallery image ${index + 1}`}
            class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"
            loading="lazy"
          />
        </div>
      ))}
    </div>
  </div>
</section>

<!-- Lightbox overlay -->
<div id="lightbox" class="fixed inset-0 bg-black/90 z-50 hidden items-center justify-center p-8">
  <button id="lightbox-close" class="absolute top-4 right-4 text-white text-4xl hover:opacity-70 transition-opacity">&times;</button>
  <img id="lightbox-image" src="" alt="Enlarged image" class="max-w-full max-h-full object-contain rounded-lg" />
</div>

<script>
  function initLightbox() {
    const lightbox = document.getElementById('lightbox');
    const lightboxImage = document.getElementById('lightbox-image') as HTMLImageElement;
    const closeBtn = document.getElementById('lightbox-close');
    const galleryItems = document.querySelectorAll('.gallery-item');

    galleryItems.forEach(item => {
      item.addEventListener('click', () => {
        const src = (item as HTMLElement).dataset.src;
        if (src && lightboxImage && lightbox) {
          lightboxImage.src = src;
          lightbox.classList.remove('hidden');
          lightbox.classList.add('flex');
        }
      });
    });

    closeBtn?.addEventListener('click', () => {
      lightbox?.classList.add('hidden');
      lightbox?.classList.remove('flex');
    });

    lightbox?.addEventListener('click', (e) => {
      if (e.target === lightbox) {
        lightbox.classList.add('hidden');
        lightbox.classList.remove('flex');
      }
    });

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && lightbox && !lightbox.classList.contains('hidden')) {
        lightbox.classList.add('hidden');
        lightbox.classList.remove('flex');
      }
    });
  }

  document.addEventListener('DOMContentLoaded', initLightbox);
</script>

